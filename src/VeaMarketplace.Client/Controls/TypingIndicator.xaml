<UserControl x:Class="VeaMarketplace.Client.Controls.TypingIndicator"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             x:Name="Root" Visibility="Collapsed">

    <UserControl.Resources>
        <Storyboard x:Key="TypingAnimation" RepeatBehavior="Forever">
            <!-- Dot 1 -->
            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Dot1"
                                           Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)">
                <EasingDoubleKeyFrame KeyTime="0:0:0" Value="0"/>
                <EasingDoubleKeyFrame KeyTime="0:0:0.15" Value="-4"/>
                <EasingDoubleKeyFrame KeyTime="0:0:0.3" Value="0"/>
                <EasingDoubleKeyFrame KeyTime="0:0:0.9" Value="0"/>
            </DoubleAnimationUsingKeyFrames>

            <!-- Dot 2 -->
            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Dot2"
                                           Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)">
                <EasingDoubleKeyFrame KeyTime="0:0:0" Value="0"/>
                <EasingDoubleKeyFrame KeyTime="0:0:0.15" Value="0"/>
                <EasingDoubleKeyFrame KeyTime="0:0:0.3" Value="-4"/>
                <EasingDoubleKeyFrame KeyTime="0:0:0.45" Value="0"/>
                <EasingDoubleKeyFrame KeyTime="0:0:0.9" Value="0"/>
            </DoubleAnimationUsingKeyFrames>

            <!-- Dot 3 -->
            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Dot3"
                                           Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)">
                <EasingDoubleKeyFrame KeyTime="0:0:0" Value="0"/>
                <EasingDoubleKeyFrame KeyTime="0:0:0.3" Value="0"/>
                <EasingDoubleKeyFrame KeyTime="0:0:0.45" Value="-4"/>
                <EasingDoubleKeyFrame KeyTime="0:0:0.6" Value="0"/>
                <EasingDoubleKeyFrame KeyTime="0:0:0.9" Value="0"/>
            </DoubleAnimationUsingKeyFrames>
        </Storyboard>
    </UserControl.Resources>

    <Border Padding="16,8" Background="{StaticResource TertiaryDarkBrush}">
        <StackPanel Orientation="Horizontal">
            <!-- Avatars of typing users -->
            <ItemsControl x:Name="TypingAvatars" Margin="0,0,8,0">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Horizontal"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border Width="20" Height="20" CornerRadius="10"
                                Margin="-6,0,0,0"
                                BorderThickness="2"
                                BorderBrush="{StaticResource TertiaryDarkBrush}">
                            <Ellipse Width="16" Height="16">
                                <Ellipse.Fill>
                                    <ImageBrush ImageSource="{Binding AvatarUrl}" Stretch="UniformToFill"/>
                                </Ellipse.Fill>
                            </Ellipse>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>

            <!-- Typing dots animation -->
            <Border Background="{StaticResource QuaternaryDarkBrush}"
                    CornerRadius="10" Padding="8,6" Margin="0,0,8,0">
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <Ellipse x:Name="Dot1" Width="6" Height="6"
                             Fill="{StaticResource TextMutedBrush}" Margin="0,0,3,0">
                        <Ellipse.RenderTransform>
                            <TranslateTransform/>
                        </Ellipse.RenderTransform>
                    </Ellipse>
                    <Ellipse x:Name="Dot2" Width="6" Height="6"
                             Fill="{StaticResource TextMutedBrush}" Margin="0,0,3,0">
                        <Ellipse.RenderTransform>
                            <TranslateTransform/>
                        </Ellipse.RenderTransform>
                    </Ellipse>
                    <Ellipse x:Name="Dot3" Width="6" Height="6"
                             Fill="{StaticResource TextMutedBrush}">
                        <Ellipse.RenderTransform>
                            <TranslateTransform/>
                        </Ellipse.RenderTransform>
                    </Ellipse>
                </StackPanel>
            </Border>

            <!-- Typing text -->
            <TextBlock x:Name="TypingText" Text="Someone is typing..."
                       FontSize="12" Foreground="{StaticResource TextMutedBrush}"
                       VerticalAlignment="Center"/>
        </StackPanel>
    </Border>
</UserControl>
