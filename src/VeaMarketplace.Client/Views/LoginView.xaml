<UserControl x:Class="VeaMarketplace.Client.Views.LoginView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="{StaticResource TertiaryDarkBrush}">

    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>

        <Storyboard x:Key="ShakeAnimation">
            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)">
                <EasingDoubleKeyFrame KeyTime="0:0:0.05" Value="10"/>
                <EasingDoubleKeyFrame KeyTime="0:0:0.1" Value="-10"/>
                <EasingDoubleKeyFrame KeyTime="0:0:0.15" Value="8"/>
                <EasingDoubleKeyFrame KeyTime="0:0:0.2" Value="-8"/>
                <EasingDoubleKeyFrame KeyTime="0:0:0.25" Value="4"/>
                <EasingDoubleKeyFrame KeyTime="0:0:0.3" Value="0"/>
            </DoubleAnimationUsingKeyFrames>
        </Storyboard>
    </UserControl.Resources>

    <Grid>
        <!-- Animated Background Gradient -->
        <Border>
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                    <GradientStop Color="#1a1a2e" Offset="0"/>
                    <GradientStop Color="#16213e" Offset="0.5"/>
                    <GradientStop Color="#0f3460" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
        </Border>

        <!-- Floating Particles Effect (decorative circles) -->
        <Canvas x:Name="ParticleCanvas" IsHitTestVisible="False">
            <Ellipse Width="100" Height="100" Opacity="0.03" Canvas.Left="50" Canvas.Top="100">
                <Ellipse.Fill>
                    <RadialGradientBrush>
                        <GradientStop Color="#5865F2" Offset="0"/>
                        <GradientStop Color="Transparent" Offset="1"/>
                    </RadialGradientBrush>
                </Ellipse.Fill>
            </Ellipse>
            <Ellipse Width="200" Height="200" Opacity="0.05" Canvas.Right="100" Canvas.Top="50">
                <Ellipse.Fill>
                    <RadialGradientBrush>
                        <GradientStop Color="#EB459E" Offset="0"/>
                        <GradientStop Color="Transparent" Offset="1"/>
                    </RadialGradientBrush>
                </Ellipse.Fill>
            </Ellipse>
            <Ellipse Width="150" Height="150" Opacity="0.04" Canvas.Left="200" Canvas.Bottom="100">
                <Ellipse.Fill>
                    <RadialGradientBrush>
                        <GradientStop Color="#57F287" Offset="0"/>
                        <GradientStop Color="Transparent" Offset="1"/>
                    </RadialGradientBrush>
                </Ellipse.Fill>
            </Ellipse>
        </Canvas>

        <!-- Login Card -->
        <Border x:Name="LoginCard"
                Background="{StaticResource SecondaryDarkBrush}"
                CornerRadius="8"
                Width="480"
                Padding="40"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Effect="{StaticResource DropShadow}">

            <Border.RenderTransform>
                <TranslateTransform/>
            </Border.RenderTransform>

            <Grid>
                <!-- Login Form -->
                <StackPanel x:Name="LoginPanel">
                    <!-- Logo and Title -->
                    <StackPanel HorizontalAlignment="Center" Margin="0,0,0,20">
                        <Border Width="80" Height="80" CornerRadius="40" Margin="0,0,0,16"
                                HorizontalAlignment="Center">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Color="#5865F2" Offset="0"/>
                                    <GradientStop Color="#EB459E" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <TextBlock Text="Y" FontSize="40" FontWeight="Bold"
                                       Foreground="White"
                                       HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>

                        <TextBlock Text="Welcome to Yurt Cord"
                                   Style="{StaticResource HeaderLarge}"
                                   HorizontalAlignment="Center"/>

                        <TextBlock x:Name="SubtitleText"
                                   Text="The marketplace with a community"
                                   Style="{StaticResource BodyText}"
                                   HorizontalAlignment="Center"
                                   Margin="0,8,0,0"/>
                    </StackPanel>

                    <!-- Error Message -->
                    <Border x:Name="ErrorBorder" Visibility="Collapsed"
                            Background="#ED4245" CornerRadius="4"
                            Padding="12,8" Margin="0,0,0,16">
                        <TextBlock x:Name="ErrorText" Foreground="White"
                                   TextWrapping="Wrap" TextAlignment="Center"/>
                    </Border>

                    <!-- Username Input -->
                    <TextBlock Text="USERNAME" FontSize="11" FontWeight="Bold"
                               Foreground="{StaticResource TextSecondaryBrush}"
                               Margin="0,0,0,8"/>
                    <TextBox x:Name="UsernameBox"
                             Style="{StaticResource ModernTextBox}"
                             Margin="0,0,0,16"/>

                    <!-- Email Input (Register only) -->
                    <StackPanel x:Name="EmailPanel" Visibility="Collapsed">
                        <TextBlock Text="EMAIL" FontSize="11" FontWeight="Bold"
                                   Foreground="{StaticResource TextSecondaryBrush}"
                                   Margin="0,0,0,8"/>
                        <TextBox x:Name="EmailBox"
                                 Style="{StaticResource ModernTextBox}"
                                 Margin="0,0,0,16"/>
                    </StackPanel>

                    <!-- Password Input -->
                    <TextBlock Text="PASSWORD" FontSize="11" FontWeight="Bold"
                               Foreground="{StaticResource TextSecondaryBrush}"
                               Margin="0,0,0,8"/>
                    <PasswordBox x:Name="PasswordBox"
                                 Style="{StaticResource ModernPasswordBox}"
                                 Margin="0,0,0,16"/>

                    <!-- Confirm Password (Register only) -->
                    <StackPanel x:Name="ConfirmPasswordPanel" Visibility="Collapsed">
                        <TextBlock Text="CONFIRM PASSWORD" FontSize="11" FontWeight="Bold"
                                   Foreground="{StaticResource TextSecondaryBrush}"
                                   Margin="0,0,0,8"/>
                        <PasswordBox x:Name="ConfirmPasswordBox"
                                     Style="{StaticResource ModernPasswordBox}"
                                     Margin="0,0,0,16"/>
                    </StackPanel>

                    <!-- Remember Me (Login only) -->
                    <CheckBox x:Name="RememberMeCheck" Content="Remember me"
                              Foreground="{StaticResource TextSecondaryBrush}"
                              Margin="0,0,0,20"/>

                    <!-- Login/Register Button -->
                    <Button x:Name="ActionButton" Content="Login"
                            Style="{StaticResource PrimaryButton}"
                            Click="ActionButton_Click"
                            Height="44"/>

                    <!-- Toggle Mode Link -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center"
                                Margin="0,16,0,0">
                        <TextBlock x:Name="TogglePromptText"
                                   Text="Need an account?"
                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                        <TextBlock x:Name="ToggleLinkText"
                                   Text="Register"
                                   Foreground="{StaticResource TextLinkBrush}"
                                   Margin="4,0,0,0"
                                   Cursor="Hand"
                                   MouseLeftButtonDown="ToggleMode_Click"/>
                    </StackPanel>
                </StackPanel>

                <!-- Loading Overlay -->
                <Border x:Name="LoadingOverlay" Visibility="Collapsed"
                        Background="#80000000" CornerRadius="8">
                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Border Width="40" Height="40" CornerRadius="20"
                                BorderBrush="{StaticResource AccentBrush}"
                                BorderThickness="3"
                                RenderTransformOrigin="0.5,0.5">
                            <Border.RenderTransform>
                                <RotateTransform x:Name="SpinnerRotation"/>
                            </Border.RenderTransform>
                            <Border.Triggers>
                                <EventTrigger RoutedEvent="Loaded">
                                    <BeginStoryboard>
                                        <Storyboard RepeatBehavior="Forever">
                                            <DoubleAnimation Storyboard.TargetName="SpinnerRotation"
                                                             Storyboard.TargetProperty="Angle"
                                                             From="0" To="360"
                                                             Duration="0:0:1"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                            </Border.Triggers>
                        </Border>
                        <TextBlock Text="Connecting..." Foreground="White"
                                   Margin="0,16,0,0"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>

        <!-- Window Controls -->
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right"
                    VerticalAlignment="Top" Margin="0,8,8,0">
            <Button Content="─" Width="32" Height="32"
                    Style="{StaticResource IconButton}"
                    Click="MinimizeButton_Click"/>
            <Button Content="✕" Width="32" Height="32"
                    Style="{StaticResource IconButton}"
                    Click="CloseButton_Click"/>
        </StackPanel>
    </Grid>
</UserControl>
